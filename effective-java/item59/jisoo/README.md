# [ITEM 59] 라이브러리를 익히고 사용하라. 
## 문제의 코드! 
```java
static Random rnd = new Random();

static int random(int n){
	return Math.abs(rnd.nextInt()) % n;
}
```
- 무작위 정수 생성을 위핸 메서드
### 문제점! 
#### 1. n 이 그리 크지 않은 2의 제곱수라면 얼마 지나지 않아 같은 수열이 반복 된다. 
##### 2. n 이 2의 제곱수가 아니라면 몇몇 숫자가 평균적으로 더 자주 반복된다.  
```java
public static void main(String[] args){
	int n = 2 * (Integer.MAX_VALUE / 3);
	int low = 0;
	for (int i = 0; i < 1000000; i++){
		if(random(n) < n/2 ){
			low++;
		}
	}
	System.out.println(low);
}
```
- 해당 문제는 n이 크면 클수록 더 명확하게 일어남 
- random 메서드가 이상적으로 동작 한다면 약 50만개가 출력돼야 한다.
- 하지만 666,666에 가까운 값을 얻는다. 무작위로 생성된 수 중에서 2/3 가량이 중간값보다 낮은 쪽으로 쏠린 것!
##### 3. 지정한 범위 '바깥' 의 수가 종종 튀어 나올 수있다. 
- rnd.nextInt()가 반환한 값을 Math.abs를 이용해 음수가 아닌 정수로 매핑하기 때문이다. 
- nextInt가 Integer.MIN_VALUE를 반환한하면 Math.abs도 Integer.MIN_VALUE를 반환하고 나머지 연산자는 음수를 반환해버린다. 
  [[스크린샷 2021-07-28 오후 4.07.02.png]]
### 해결법
- 이러한 결함을 해결하라면 의사난수 생성기, 정수론, 2의 보수 계산 등에 조예가 깊어야한다! 
- 하지만! 우리가 직접 해결할 필요는없다! 
#### Random.nextInt(int) <- 표준 라이브러리
- 이메서드는 알고리즘에 능통한 개발자가 설계와 구현과 검증에 시간을 들여 개발했고, 이 분야의 여러 전문가가 잘 동작함을 검증해줬다. 
#### ThreadLocalRandom
- 자바 7부터는 Random을 더이상 사용하지 말고 ThreadLocalRandom으로 대체하면 대부분 잘 작동한다. 
- Random보다 더 고품질의 무작위 수를 생성 할 뿐 아니라 속도도 더 빠르다. 
#### SplittableRandom 
- 포크-조인 풀이나 병렬 스트림에서는 SplittableRandom을 사용 하라. 
### 표준 라이브러리를 사용하라
#### 사용 이점
1. 그 코드를 작성한 전문가의 지식과 여러분보다 앞서 사용한 다른 프로그래머들의 경험을 활용할 수 있다. 
2. 핵짐적인 일과 크게 관련 없는 문제를 해결 하느라 시간을 낭비 하지 않아도 된다. 
3. 따로 노력하지 않아도 성능이 지속해서 개선된다. 
4. 기능이 점점 많아진다. 
5. 내가 작성한 코드가 많은 사람에게 낯익은 코드가 된다. 

#### 하지만?
- 표준라이브러이의 이러한 이점이 있지만 대부분 직접 구현하여 사용한다. 
		-> 라이브러리의 존재 자체도 모르기 때문 일것이다. 
- 자바는 메이저 릴리즈 마다 새로운 기능을 설명 하는데 이러한 문서를 한번쯤 읽어 볼만 한다. 
- java.lang,, java.util, java.io와 그 하위 패키지들에는 익숙해져야 한다. 

#### 익숙해지면 좋은 라이브러리
- 컬렉션 프레임워크[[Item45]]
- 스트림 라이브러리
- java.util.concurrent [[Item80]], [[Item81]]
- 



  